# TEST

### repository

repository 에는 DB 에 접근하는 쿼리만을 담습니다.

실제 쿼리에 대한 테스트를 진행하기 위해 테스트용 db 와 연결하여 테스트합니다.

[예제](./post.repository.spec.ts)

### entity

도메인 로직을 담고 있는 매우 중요한 객체입니다.

정의되어 있는 메서드들은 테스트 코드를 작성하여 도메인 로직에 대한 신뢰성을 높이는 것이 좋습니다.

http 통신, db 접근 등 외부와 의존하는 부분이 없으므로 테스트하기 편합니다. (경우에 따라서는 repository 를 주입할 수도 있습니다.)

[예제](./post.spec.ts)

### service

비지니스 로직이 모여있는 부분입니다. 여러 의존성을 가질 가능성이 높아, 격리된 테스트 코드를 작성하기 껄끄럽습니다.

의존하는 대상의 결과를 조작할 수 있게 여러 도구가 나왔지만, 남용하게 되면 테스트의 테스트 대상의 구현에 의존하게 되어 조금만 고쳐도 테스트가 깨지는 경우가 발생하기 쉽습니다.

작성이 필요하다면 spy, mock 과 같은 도구는 최소한으로 사용하여 유지하기 좋은 코드를 만들 필요가 있습니다.

사실 repository, entity 와 같이 주요한 로직을 포함하지 않는 service 객체에 대해서 유닛 테스트를 하는 것에 약간 의문을 가지고 있습니다.

시간이 많지 않다면 중요한 로직에 대한 테스트 코드를 작성하고, e2e 로 테스트하는 것이 조금 더 올바른 방법이지 않을까 생각하고 있습니다.

[예제](./post.service.spec.ts)

### e2e

실행할 때마다 초기 데이터를 넣고 테스트가 끝나면 비우는 방식으로 하는지, 데이터에 변화를 주지 않도록 롤백하는 형식으로 하는지...

BP 가 필요합니다.
